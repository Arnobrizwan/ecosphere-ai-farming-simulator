# Disease Detection Model Assets

This directory contains the trained model and metadata for UC21 - Crop Disease Detection.

## Files

### plant_disease_model.tflite
- **Type:** TensorFlow Lite model
- **Size:** ~8-12 MB (optimized for mobile)
- **Input:** 224x224 RGB image
- **Output:** Probability distribution over 32 disease classes
- **Framework:** TensorFlow Lite
- **Architecture:** MobileNetV2 transfer learning

**Note:** This file is generated by running the training script in `/model-training/train_disease_model.py`. It's excluded from git (see .gitignore).

### labels.json
- **Type:** JSON mapping file
- **Purpose:** Maps class indices (0-31) to disease names
- **Format:** `{ "0": "Apple___Apple_scab", "1": "Apple___Black_rot", ... }`

### treatments.json
- **Type:** JSON treatment database
- **Purpose:** Provides treatment recommendations for each disease
- **Fields per disease:**
  - `severity`: "none" | "low" | "medium" | "high"
  - `treatment`: Short description
  - `steps`: Array of treatment steps
  - `prevention`: Prevention advice

## Generating the Model

To generate `plant_disease_model.tflite`:

```bash
cd model-training
python train_disease_model.py
```

The model will be automatically saved to this directory.

## Model Usage in App

The model is loaded at app startup using `src/utils/modelLoader.js` and used by `src/services/diseaseDetectionService.js` for inference.

### Preprocessing
Images are preprocessed before inference:
1. Resize to 224x224 pixels
2. Convert to RGB (3 channels)
3. Normalize pixel values to [0, 1]
4. Expand dimensions to match model input shape

### Inference
```javascript
const predictions = await detectCropDisease(imageUri);
// Returns top 3 predictions with confidence scores
```

### Output Format
```javascript
{
  success: true,
  predictions: [
    { label: "Tomato___Early_blight", confidence: 0.87, class: 20 },
    { label: "Tomato___Septoria_leaf_spot", confidence: 0.09, class: 23 },
    { label: "Tomato___Late_blight", confidence: 0.02, class: 21 }
  ],
  treatment: { /* treatment info from treatments.json */ }
}
```

## Supported Crops & Diseases

### Apple (4 classes)
- Apple scab
- Black rot
- Cedar apple rust
- Healthy

### Corn/Maize (4 classes)
- Cercospora leaf spot / Gray leaf spot
- Common rust
- Northern Leaf Blight
- Healthy

### Grape (4 classes)
- Black rot
- Esca (Black Measles)
- Leaf blight (Isariopsis Leaf Spot)
- Healthy

### Potato (3 classes)
- Early blight
- Late blight
- Healthy

### Rice (4 classes)
- Bacterial leaf blight
- Brown spot
- Leaf smut
- Healthy

### Tomato (10 classes)
- Bacterial spot
- Early blight
- Late blight
- Leaf Mold
- Septoria leaf spot
- Spider mites
- Target Spot
- Yellow Leaf Curl Virus
- Tomato mosaic virus
- Healthy

### Wheat (3 classes)
- Brown rust
- Yellow rust
- Healthy

**Total:** 32 classes across 7 crop types

## Performance Metrics

### Target Metrics
- ✓ Accuracy: >85%
- ✓ Top-3 Accuracy: >90%
- ✓ Model Size: <20MB
- ✓ Inference Time: <3s on device

### Typical Performance
- **Validation Accuracy:** 85-92%
- **Top-3 Accuracy:** 95-98%
- **Model Size:** 8-12 MB
- **Mobile Inference:** 1-2 seconds (on modern smartphones)

## Updating the Model

To retrain with new data or improved architecture:

1. Update training script: `model-training/train_disease_model.py`
2. Run training: `python train_disease_model.py`
3. New model will overwrite `plant_disease_model.tflite`
4. Update `labels.json` if classes changed
5. Update `treatments.json` with new disease treatments
6. Test in app before deploying

## Version History

- **v1.0** (2025-01-02): Initial model with 32 classes, MobileNetV2 architecture
